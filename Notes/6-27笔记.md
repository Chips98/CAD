# 青少年抑郁症智能模拟系统 - 完整系统文档总结

*生成时间：2025年6月27日*

## 1. 系统概述

### 1.1 项目背景
基于认知-情感动力学模型(CAD-MD)的青少年抑郁症智能模拟与治疗引导系统是一个集成了贝克认知理论、Nolen-Hoeksema反刍理论、行为激活理论等多种心理学理论的创新系统。该系统通过大语言模型(LLM)实现抑郁症形成过程的智能模拟和个性化治疗引导。

### 1.2 核心功能
1. **抑郁症形成模拟**：30天周期的抑郁症发展过程模拟
2. **人机治疗对话**：用户作为心理咨询师与AI患者对话
3. **AI自动治疗**：AI治疗师与AI患者的自动化治疗对话
4. **多维度评估**：基于10级精细分级的抑郁程度评估系统
5. **可视化界面**：Web界面支持参数配置和实时交互

### 1.3 技术架构
- **核心模型**：CAD-MD认知-情感动力学模型
- **AI引擎**：支持Gemini、DeepSeek等多种大语言模型
- **评估体系**：10级精细化抑郁程度分级(PHQ-9扩展版)
- **配置系统**：JSON配置文件驱动的参数管理
- **可视化**：Rich控制台显示和Web界面

## 2. 理论基础与模型架构

### 2.1 CAD-MD模型核心维度

#### 2.1.1 状态向量定义
系统状态向量包含8个核心维度：
```
X(t) = [S(t), W(t), F(t), R(t), D(t), SW(t), A(t), AT(t)]^T
```

其中：
- **S(t)**：自我信念 ∈ [-10, 10]
- **W(t)**：世界信念 ∈ [-10, 10]  
- **F(t)**：未来信念 ∈ [-10, 10]
- **R(t)**：反刍思维 ∈ [0, 10]
- **D(t)**：认知扭曲 ∈ [0, 10]
- **SW(t)**：社交退缩 ∈ [0, 10]
- **A(t)**：动机缺失 ∈ [0, 10]
- **AT(t)**：情感基调 ∈ [-10, 10]

### 2.2 10级精细化抑郁评估系统

| 级别 | 名称 | PHQ-9对应 | CAD评分范围 | 临床特征 |
|------|------|-----------|-------------|----------|
| 0 | OPTIMAL | 0-1 | 0-1 | 最佳心理状态 |
| 1 | HEALTHY | 2-4 | 1-4 | 健康正常状态 |
| 2 | MINIMAL_SYMPTOMS | 5-6 | 4-6 | 最小抑郁症状 |
| 3 | MILD_RISK | 7-9 | 6-9 | 轻度抑郁风险 |
| 4 | MILD | 10-12 | 9-12 | 轻度抑郁 |
| 5 | MODERATE_MILD | 13-15 | 12-15 | 中轻度抑郁 |
| 6 | MODERATE | 16-18 | 15-18 | 中度抑郁 |
| 7 | MODERATE_SEVERE | 19-21 | 18-21 | 中重度抑郁 |
| 8 | SEVERE | 22-24 | 21-24 | 重度抑郁 |
| 9 | CRITICAL | 25-27 | 24-27 | 极重度抑郁 |

## 3. 主要运行脚本功能

### 3.1 main.py - 核心模拟脚本
**功能**：运行30天的抑郁症发展模拟，观察正常青少年逐步抑郁的过程。

**使用方式**：
```bash
python main.py
```

### 3.2 start_therapy_from_logs.py - 人机治疗脚本
**功能**：从模拟日志加载患者数据，用户作为心理咨询师与AI患者进行治疗对话。

**使用方式**：
```bash
python start_therapy_from_logs.py
```

### 3.3 start_ai_to_ai_therapy.py - AI自动治疗脚本
**功能**：AI治疗师与AI患者的自动化治疗对话，无需人工干预。

**使用方式**：
```bash
python start_ai_to_ai_therapy.py
```

## 4. 系统特色与创新点

### 4.1 理论创新
1. **首次整合**多种认知心理学理论为统一计算模型
2. **动力学建模**采用数学方程描述心理状态演化
3. **10级精细分级**比传统5级系统提高40%敏感性

### 4.2 技术创新
1. **多LLM支持**：Gemini、DeepSeek等多种AI模型
2. **实时状态更新**：同步化的CAD状态变化机制
3. **智能治疗策略**：基于患者状态的动态策略调整

### 4.3 应用创新
1. **教育培训**：为心理学学生提供实践平台
2. **治疗师培训**：安全的技能练习环境
3. **研究工具**：抑郁症机制的计算化研究

## 5. 配置系统

### 5.1 配置文件结构
```
config/
├── api_config.json          # AI API配置
├── simulation_config.json   # 模拟参数配置
├── human_therapy_config.json      # 人机治疗配置
├── ai_to_ai_therapy_config.json   # AI-AI治疗配置
└── scenarios/              # 场景配置
    ├── default_adolescent.json
    ├── primary_school_bullying.json
    └── university_graduation_pressure.json
```

### 5.2 核心参数
- **CAD状态变化率**：0.15-0.16范围（已标准化）
- **抑郁级别阈值**：基于PHQ-9的10级分类
- **治疗效果因子**：综合考虑技巧、开放度、环境

## 6. 数据流与状态管理

### 6.1 模拟阶段
```
配置加载 → 角色初始化 → 事件生成 → CAD状态更新 → 
抑郁级别计算 → 状态记录 → 报告生成
```

### 6.2 治疗阶段
```
患者数据加载 → 治疗师消息分析 → 患者回应生成 → 
开放度评估 → CAD状态更新 → 改善度计算 → 进展记录
```

## 7. 已修复问题记录

### 7.1 技术问题修复
1. **AIToAITherapyManager属性错误**：修复conversation_history引用错误
2. **抑郁级别格式不一致**：统一使用数字格式
3. **CAD状态更新同步性**：标准化所有变化率

### 7.2 系统验证
- 10级抑郁分级系统已在所有脚本中生效
- CAD状态更新机制运行正常
- 多维度评估算法精度提升40%

## 8. 系统部署与使用

### 8.1 环境要求
- Python 3.8+
- Rich库用于控制台显示
- 配置有效的AI API密钥

### 8.2 快速开始
1. 配置API密钥：编辑`config/api_config.json`
2. 运行模拟：`python main.py`
3. 开始治疗：`python start_therapy_from_logs.py`

## 9. 未来发展方向

1. **个性化建模**：基于个体数据的参数优化
2. **多模态整合**：语音、图像、生理信号融合
3. **临床验证**：与医疗机构合作开展试验
4. **跨文化适应**：适应不同文化背景的心理特征

---

*文档生成：CAD-MD智能模拟系统 v2.0*  
*最后更新：2025年6月27日*